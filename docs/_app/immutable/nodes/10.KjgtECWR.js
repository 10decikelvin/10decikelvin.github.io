import{s as T,n as G,r as z,b as I,i as ee,j as te}from"../chunks/scheduler.50shW1w6.js";import{S as j,i as H,g,s as L,h as $,c as S,j as q,y as O,f as k,k as i,a as P,z as w,A as F,m as V,n as W,o as ne,r as J,u as Q,v as X,d as Y,t as Z,w as x,F as le,l as M,G as D}from"../chunks/index.HJRhwQZU.js";import{G as se}from"../chunks/Grid.l-bmQf7Y.js";/* empty css                                                          */function ae(l){let e;return{c(){e=V("No file selected")},l(n){e=W(n,"No file selected")},m(n,t){P(n,e,t)},p:G,d(n){n&&k(e)}}}function ie(l){let e=l[0][0].name+"",n;return{c(){n=V(e)},l(t){n=W(t,e)},m(t,s){P(t,n,s)},p(t,s){s&1&&e!==(e=t[0][0].name+"")&&ne(n,e)},d(t){t&&k(n)}}}function re(l){let e,n,t,s,p="Browse",b,a,c,h;function _(r,y){return r[0]?ie:ae}let f=_(l),u=f(l);return{c(){e=g("input"),n=L(),t=g("label"),s=g("b"),s.textContent=p,b=L(),a=g("span"),u.c(),this.h()},l(r){e=$(r,"INPUT",{type:!0,id:!0,accept:!0,class:!0}),n=S(r),t=$(r,"LABEL",{for:!0,tabindex:!0,class:!0});var y=q(t);s=$(y,"B",{class:!0,"data-svelte-h":!0}),O(s)!=="svelte-8cpmva"&&(s.textContent=p),b=S(y),a=$(y,"SPAN",{class:!0});var o=q(a);u.l(o),o.forEach(k),y.forEach(k),this.h()},h(){i(e,"type","file"),i(e,"id",l[2]),i(e,"accept","*/*"),i(e,"class","svelte-7wz4vl"),i(s,"class","svelte-7wz4vl"),i(a,"class","svelte-7wz4vl"),i(t,"for",l[2]),i(t,"tabindex","0"),i(t,"class","svelte-7wz4vl")},m(r,y){P(r,e,y),l[4](e),P(r,n,y),P(r,t,y),w(t,s),w(t,b),w(t,a),u.m(a,null),c||(h=[F(e,"change",l[3]),F(t,"keypress",l[5])],c=!0)},p(r,[y]){f===(f=_(r))&&u?u.p(r,y):(u.d(1),u=f(r),u&&(u.c(),u.m(a,null)))},i:G,o:G,d(r){r&&(k(e),k(n),k(t)),l[4](null),u.d(),c=!1,z(h)}}}function oe(l,e,n){let{files:t}=e,s,p=`file-input-${Math.random()}`;function b(){t=this.files,n(0,t)}function a(h){I[h?"unshift":"push"](()=>{s=h,n(1,s)})}const c=h=>h.key==="Enter"&&(s==null?void 0:s.click());return l.$$set=h=>{"files"in h&&n(0,t=h.files)},[t,s,p,b,a,c]}class ce extends j{constructor(e){super(),H(this,e,oe,re,T,{files:0})}}function ue(l){let e,n,t='<b class="svelte-gmqvls">AES-GCM</b> File Encrypt',s,p,b,a,c,h,_,f,u,r,y,o,E,K,v,B,U;function A(d){l[5](d)}let N={};return l[0]!==void 0&&(N.files=l[0]),p=new ce({props:N}),I.push(()=>le(p,"files",A)),{c(){e=g("form"),n=g("h1"),n.innerHTML=t,s=L(),J(p.$$.fragment),a=L(),c=g("input"),h=L(),_=g("div"),f=g("input"),y=L(),o=g("input"),this.h()},l(d){e=$(d,"FORM",{class:!0});var m=q(e);n=$(m,"H1",{class:!0,"data-svelte-h":!0}),O(n)!=="svelte-g5czp9"&&(n.innerHTML=t),s=S(m),Q(p.$$.fragment,m),a=S(m),c=$(m,"INPUT",{type:!0,placeholder:!0,class:!0}),h=S(m),_=$(m,"DIV",{class:!0});var C=q(_);f=$(C,"INPUT",{type:!0,id:!0,title:!0,class:!0}),y=S(C),o=$(C,"INPUT",{type:!0,id:!0,title:!0,class:!0}),C.forEach(k),m.forEach(k),this.h()},h(){i(n,"class","svelte-gmqvls"),i(c,"type","text"),i(c,"placeholder","Encryption Key"),i(c,"class","svelte-gmqvls"),i(f,"type","submit"),i(f,"id","encrypt"),f.value="Encrypt",f.disabled=u=!l[2],i(f,"title",r=l[2]?"":".enc files can be decrypted, not encrypted."),i(f,"class","svelte-gmqvls"),M(f,"text-decoration",l[2]?"none":"line-through"),i(o,"type","submit"),i(o,"id","decrypt"),o.value="Decrypt",o.disabled=E=!l[3],i(o,"title",K=l[3]?"":"Only .enc files produced by this webpage can be decrypted."),i(o,"class","svelte-gmqvls"),M(o,"text-decoration",l[3]?"none":"line-through"),i(_,"class","buttons svelte-gmqvls"),i(e,"class","svelte-gmqvls")},m(d,m){P(d,e,m),w(e,n),w(e,s),X(p,e,null),w(e,a),w(e,c),D(c,l[1]),w(e,h),w(e,_),w(_,f),w(_,y),w(_,o),v=!0,B||(U=[F(c,"input",l[6]),F(e,"submit",l[4])],B=!0)},p(d,m){const C={};!b&&m&1&&(b=!0,C.files=d[0],te(()=>b=!1)),p.$set(C),m&2&&c.value!==d[1]&&D(c,d[1]),(!v||m&4&&u!==(u=!d[2]))&&(f.disabled=u),(!v||m&4&&r!==(r=d[2]?"":".enc files can be decrypted, not encrypted."))&&i(f,"title",r),m&4&&M(f,"text-decoration",d[2]?"none":"line-through"),(!v||m&8&&E!==(E=!d[3]))&&(o.disabled=E),(!v||m&8&&K!==(K=d[3]?"":"Only .enc files produced by this webpage can be decrypted."))&&i(o,"title",K),m&8&&M(o,"text-decoration",d[3]?"none":"line-through")},i(d){v||(Y(p.$$.fragment,d),v=!0)},o(d){Z(p.$$.fragment,d),v=!1},d(d){d&&k(e),x(p),B=!1,z(U)}}}function de(l){let e,n;return e=new se({props:{$$slots:{default:[ue]},$$scope:{ctx:l}}}),{c(){J(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,s){X(e,t,s),n=!0},p(t,[s]){const p={};s&1039&&(p.$$scope={dirty:s,ctx:t}),e.$set(p)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){x(e,t)}}}function R(l,e){var n=new Uint8Array(l.byteLength+e.byteLength);return n.set(new Uint8Array(l),0),n.set(new Uint8Array(e),l.byteLength),n.buffer}function pe(l,e,n){let t,s,p=ee("toast"),b=new TextEncoder,a,c="";async function h(u){var r,y;if(!a){p.add("No file selected");return}if(((r=u.submitter)==null?void 0:r.id)==="encrypt"){const o=window.crypto.getRandomValues(new Uint8Array(64)),E=window.crypto.getRandomValues(new Uint8Array(64)),K=await window.crypto.subtle.importKey("raw",b.encode(c),"PBKDF2",!1,["deriveKey"]),v=await window.crypto.subtle.deriveKey({name:"PBKDF2",hash:"SHA-256",salt:E,iterations:8192},K,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"]);let B=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},v,await a[0].arrayBuffer());const U=R(o,R(E,B));let A=document.createElement("a");A.href=window.URL.createObjectURL(new Blob([U])),A.download=a[0].name+".enc",A.click()}else if(((y=u.submitter)==null?void 0:y.id)==="decrypt"){let o=await a[0].arrayBuffer(),E=o.slice(0,64),K=o.slice(64,128);const v=await window.crypto.subtle.importKey("raw",b.encode(c),"PBKDF2",!0,["deriveKey","deriveBits"]),B=await window.crypto.subtle.deriveKey({name:"PBKDF2",hash:"SHA-256",salt:K,iterations:8192},v,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);try{let U=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:E},B,o.slice(128)),A=document.createElement("a");A.href=window.URL.createObjectURL(new Blob([U])),A.download=a[0].name.replace(/\.enc$/,""),A.click()}catch{console.log("caught"),p.add("Incorrect decryption key.");debugger}}}function _(u){a=u,n(0,a)}function f(){c=this.value,n(1,c)}return l.$$.update=()=>{l.$$.dirty&1&&n(3,t=!a||a[0].name.endsWith(".enc")),l.$$.dirty&1&&n(2,s=!a||!a[0].name.endsWith(".enc"))},[a,c,s,t,h,_,f]}class _e extends j{constructor(e){super(),H(this,e,pe,de,T,{})}}export{_e as component};
