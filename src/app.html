<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="%sveltekit.assets%/favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		%sveltekit.head%
		<script>
			let div = document.createElement("div");
			let div2 = document.createElement("div2");
			document.addEventListener("DOMContentLoaded", () => {
				div.appendChild(div2);
				document.body.appendChild(div);
				div.classList.add("invisible-container");
				div2.classList.add("invisible-sizer");
			})

			function getVh(vh){
				return div2.clientHeight / 100 * vh;
			}
			function getVw(vw){
				return div2.clientWidth / 100 * vw;
			}
			let heights = [1,1,1];
			window.addEventListener("load", () => {
				heights = ["#slide-1", "#slide-2", "#slide-3"].map(s => document.querySelector(s)?.clientHeight || 0);
				console.log(heights);
			})

			let lastPos = 0;
			function scale(pos, topPos, height){
				return Math.max(0, Math.min(1, (pos - topPos) / height))
			}
			function loop(){
				let pos =  document.documentElement.scrollTop;
				if(pos != lastPos){
					lastPos = pos;
					document.documentElement.style.setProperty('--scroll-progress', `${pos / getVh(90)}`)
					document.documentElement.style.setProperty('--scroll-progress-1', `${scale(pos, 0, heights[0])}`)
					document.documentElement.style.setProperty('--scroll-progress-2', `${scale(pos, heights[0], heights[1])}`)
					document.documentElement.style.setProperty('--scroll-progress-3', `${scale(pos, heights[0] + heights[1], heights[2])}`)

				}
				requestAnimationFrame(loop);
			}
			loop();
		</script>
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">%sveltekit.body%</div>
	</body>
</html>
